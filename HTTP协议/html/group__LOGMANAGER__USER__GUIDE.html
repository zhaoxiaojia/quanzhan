<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACS: LogManager User Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ACS
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__LOGMANAGER__USER__GUIDE.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LogManager User Guide<div class="ingroups"><a class="el" href="group__ACS__CORE__DOCS.html">ACS Core Docs</a> &raquo; <a class="el" href="group__USER__GUIDE.html">Middleware User Guides</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for LogManager User Guide:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__LOGMANAGER__USER__GUIDE.png" border="0" alt="" usemap="#group____LOGMANAGER____USER____GUIDE"/>
<map name="group____LOGMANAGER____USER____GUIDE" id="group____LOGMANAGER____USER____GUIDE">
<area shape="rect" id="node2" href="group__USER__GUIDE.html" title="Middleware User Guides" alt="" coords="5,5,171,32"/>
</map>
</td></tr></table></center>
</div>
<p><b>Version Number:</b> 1.0</p>
<ul>
<li><a class="el" href="group__LOGMANAGER__USER__GUIDE.html#LogManager_section_1">Introduction</a></li>
<li><a class="el" href="group__LOGMANAGER__USER__GUIDE.html#LogManager_section_2">Prerequisites</a></li>
<li><a class="el" href="group__LOGMANAGER__USER__GUIDE.html#LogManager_section_3">Usage/Best Practices</a></li>
<li><a class="el" href="group__LOGMANAGER__USER__GUIDE.html#LogManager_section_4">Build Artifacts</a></li>
<li><a class="el" href="group__LOGMANAGER__USER__GUIDE.html#LogManager_section_5">FAQ</a></li>
<li><a class="el" href="group__LOGMANAGER__USER__GUIDE.html#LogManager_section_6">References</a></li>
</ul>
<h1><a class="anchor" id="LogManager_section_1"></a>
Introduction</h1>
<p>The ACS LogManager library supports uploading device logs and crashes to DeviceEventTracker. Device Logs uploaded to DeviceEventTracker can be accessed on EventDashBoard by developers to analyse and debug issues with their software running on ACS. Device Crashes uploaded to DeviceEventTracker can be accessed on Crashboard by developers to analyse and improve their software stability.</p>
<h1><a class="anchor" id="LogManager_section_2"></a>
Prerequisites</h1>
<ul>
<li>Required HALs:<ul>
<li><a class="el" href="group__ACE__HAL__KV__STORAGE.html">KV Storage</a><ul>
<li>This is used to retrieve marketplace and COR for the device</li>
</ul>
</li>
<li><a class="el" href="group__ACE__HAL__DEVICE__INFO.html">Device Info</a><ul>
<li>This is used for access device related information</li>
</ul>
</li>
</ul>
</li>
<li>Required middleware:<ul>
<li>ACM<ul>
<li>This is used as the HTTP client interface</li>
</ul>
</li>
<li>Metrics<ul>
<li>This is used to record metrics about log and crash uploads</li>
</ul>
</li>
</ul>
</li>
<li>Required OSS libraries:<ul>
<li>mbedtls<ul>
<li>This is used for TLS connection</li>
</ul>
</li>
<li>cJSON2<ul>
<li>This is used for JSON parsing</li>
</ul>
</li>
</ul>
</li>
<li>Required DPK components:<ul>
<li>ACE_LOG<ul>
<li>This is used for logging purposes</li>
</ul>
</li>
<li><a class="el" href="group__OSAL.html">OSAL</a><ul>
<li>For OS agnostic primitives</li>
</ul>
</li>
<li><a class="el" href="group__ACE__DISPATCHER.html">ACE Dispatcher</a><ul>
<li>This is used to process internal and ACM asynchronous events</li>
</ul>
</li>
<li><a class="el" href="group__ACE__IPC.html">ACE IPC</a><ul>
<li>This is used for receiving notifications for log/crash upload from other modules</li>
</ul>
</li>
<li>ACE_DROPBOX<ul>
<li>This is used for retrieving device logs and crashes for upload</li>
</ul>
</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="LogManager_section_3"></a>
Usage/Best Practices</h1>
<ul>
<li>API call example: <div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> onUpload_completed(uint32_t <span class="keywordtype">id</span>,<a class="code" href="group__ACE__LOGMGR__DATA.html#gaf61f31b63abcb23bb36c8f352c439e7a">log_upload_event_t</a> event)</div><div class="line">{</div><div class="line">    printf(<span class="stringliteral">&quot;Upload completed with id:%d status:%d&quot;</span>, <span class="keywordtype">id</span>, event);</div><div class="line">}</div><div class="line"></div><div class="line"><span class="comment">// Upload param consists of uploadTag which can be used to fetch  </span></div><div class="line"><span class="comment">// log/crash upload on the DeviceEventTracker Service</span></div><div class="line"><span class="preprocessor">#define UPLOAD_PARAM &quot;{\&quot;UPLOAD_TAG\&quot;:\&quot;Test-Upload-Tag\&quot;}&quot;</span></div><div class="line"></div><div class="line"><a class="code" href="ace__status_8h.html#aacd7ede39583d4c0553059d25ba05082">ace_status_t</a> upload_log_crash() {</div><div class="line">    printf(<span class="stringliteral">&quot;Uploading logs and crashes ...\n&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="group__ACE__LOGMGR__API.html#gaef142b6f8eefbef37fcb595b993a232e">aceLogmgr_init</a>();</div><div class="line">    printf(<span class="stringliteral">&quot;Initialized LogManager&quot;</span>);</div><div class="line">    </div><div class="line">    <a class="code" href="structaceDispatcher__module__s.html">aceDispatcher_module_t</a> module;</div><div class="line">    <a class="code" href="group__ACE__LOGMGR__API.html#ga5fa8aa1824ee34b696c53f92bed3ffb0">aceLogmgr_init_module_reg</a>(&amp;module);</div><div class="line">    printf(<span class="stringliteral">&quot;Registered LogManager to Dispatcher&quot;</span>);</div><div class="line"></div><div class="line">    <a class="code" href="structaceLogmgr__Msg.html">aceLogmgr_Msg_t</a> l_msg;</div><div class="line">    l_msg.<a class="code" href="structaceLogmgr__Msg.html#a57b445c80540d8beb22e37508b20c876">event</a> = <a class="code" href="group__ACE__LOGMGR__DATA.html#ggafdf13a7100f2dd40fe313f9329cfb259a3868040801e44fbf774823428a22e59e">ACE_LOGMGR_EVENT_UPLOAD_LOG</a>;<span class="comment">// Event to upload log</span></div><div class="line">    l_msg.<a class="code" href="structaceLogmgr__Msg.html#a4938e31ec08c0f7cf84cfb199673884c">source</a> = <a class="code" href="group__ACE__LOGMGR__DATA.html#gga06c9c336c7826864ab5f1bb141d037f0a9d92fc8c2223c6dbdbf99619254e1101">ACE_LOGMGR_SOURCE_PUFFIN</a>;</div><div class="line">    l_msg.<a class="code" href="structaceLogmgr__Msg.html#a572a61afbab12059d44ca96889f80e62">payload</a> = malloc(strlen(UPLOAD_PARAM)+1);</div><div class="line">    strncpy(l_msg.<a class="code" href="structaceLogmgr__Msg.html#a572a61afbab12059d44ca96889f80e62">payload</a>, UPLOAD_PARAM, strlen(UPLOAD_PARAM));</div><div class="line"></div><div class="line">    <a class="code" href="group__ACE__LOGMGR__API.html#gae68959cd436a3eafcb2de09e3433a3e9">aceLogmgr_send_msg_with_callback</a>(&amp;l_msg, onUpload_completed, 0);</div><div class="line">    printf(<span class="stringliteral">&quot;Triggered upload log&quot;</span>); </div><div class="line"></div><div class="line">    <a class="code" href="structaceLogmgr__Msg.html">aceLogmgr_Msg_t</a> c_msg;</div><div class="line">    c_msg.<a class="code" href="structaceLogmgr__Msg.html#a57b445c80540d8beb22e37508b20c876">event</a> = <a class="code" href="group__ACE__LOGMGR__DATA.html#ggafdf13a7100f2dd40fe313f9329cfb259a840c17744a950f7f4af177dbf7765304">ACE_LOGMGR_EVENT_UPLOAD_CRASH</a>;<span class="comment">// Event to upload crash</span></div><div class="line">    c_msg.<a class="code" href="structaceLogmgr__Msg.html#a4938e31ec08c0f7cf84cfb199673884c">source</a> = <a class="code" href="group__ACE__LOGMGR__DATA.html#gga06c9c336c7826864ab5f1bb141d037f0a5396f911a13f7a3be8936abf83f516f5">ACE_LOGMGR_SOURCE_ACP</a>;</div><div class="line">    c_msg.<a class="code" href="structaceLogmgr__Msg.html#a572a61afbab12059d44ca96889f80e62">payload</a> = malloc(strlen(UPLOAD_PARAM)+1);</div><div class="line">    strncpy(c_msg.<a class="code" href="structaceLogmgr__Msg.html#a572a61afbab12059d44ca96889f80e62">payload</a>, UPLOAD_PARAM, strlen(UPLOAD_PARAM));</div><div class="line"></div><div class="line">    <a class="code" href="group__ACE__LOGMGR__API.html#gae68959cd436a3eafcb2de09e3433a3e9">aceLogmgr_send_msg_with_callback</a>(&amp;c_msg, onUpload_completed, 0);</div><div class="line">    printf(<span class="stringliteral">&quot;Triggered upload crash&quot;</span>); </div><div class="line"></div><div class="line">}</div></div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="LogManager_section_4"></a>
Build Artifacts</h1>
<ul>
<li>Shared library name: libace_logmgr</li>
</ul>
<h1><a class="anchor" id="LogManager_section_5"></a>
FAQ</h1>
<ol type="1">
<li>Q: How can I find the logs/crashes which are uploaded on the service? A: Logs/Crashes can be retrieved on the service by entering the device information like DeviceSerialNumber, DeviceType and the uploadTag with which the log was uploaded. Logs/Crashes can be uploaded from the device every time using different uploadTag so that a specific log upload can be retrieved on the service. Crashes can also be searched on the crashboard based on crashType, osBuildVersion, platform, hardware, manufacturer etc.</li>
<li>Q: I triggered log/crash upload but cannot find it in service. What should I do? A: Log Upload could have failed because of Wi-Fi connectivity. Check if device is connected to Wi-Fi. There could be no log/crash file present in the device to be uploaded which means all the previous log/crashes are already uploaded.</li>
<li>Q: What are the different log/crash types which are uploaded? A: Refer to Dropbox "API documentation” for the list of log/crash types supported on a platform. LogManager supports uploading of all log/crash types supported by dropbox. Only a subset of log or crash can be uploaded by adding another Json attribute ‘logType’ in the payload with value containing an array of log/crash types.</li>
<li>Q: How long can I find the logs/crashes on the service? A: Logs/Crashes are persisted for 60 days on the service.</li>
<li>Q: Can I trigger log/crash upload without an uploadTag? A: Yes, If application does not pass an uploadTag, LogManager will create a random uploadTag and upload the logs/crashes.</li>
</ol>
<h1><a class="anchor" id="LogManager_section_6"></a>
References</h1>
<p>For detailed information on individual APIs, please refer to the <a class="el" href="group__ACE__LOGMGR.html">API documentation</a>. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
