<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACS: ACE Tester User Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ACS
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__ACE__TESTER__USER__GUIDE.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ACE Tester User Guide<div class="ingroups"><a class="el" href="group__ACS__CORE__DOCS.html">ACS Core Docs</a> &raquo; <a class="el" href="group__TESTING__GUIDE.html">Testing Guides</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for ACE Tester User Guide:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__ACE__TESTER__USER__GUIDE.png" border="0" alt="" usemap="#group____ACE____TESTER____USER____GUIDE"/>
<map name="group____ACE____TESTER____USER____GUIDE" id="group____ACE____TESTER____USER____GUIDE">
<area shape="rect" id="node2" href="group__TESTING__GUIDE.html" title="Testing Guides" alt="" coords="5,5,116,32"/>
</map>
</td></tr></table></center>
</div>
<ul>
<li><a class="el" href="group__ACE__TESTER__USER__GUIDE.html#ace_tester_section1">1. Get ACE Tester</a></li>
<li><a class="el" href="group__ACE__TESTER__USER__GUIDE.html#ace_tester_section2">2. Include test in the build</a></li>
<li><a class="el" href="group__ACE__TESTER__USER__GUIDE.html#ace_tester_section3">3. Basic ACE Tester configurations</a></li>
<li><a class="el" href="group__ACE__TESTER__USER__GUIDE.html#ace_tester_section4">4. Basic test setup validation</a></li>
<li><a class="el" href="group__ACE__TESTER__USER__GUIDE.html#ace_tester_section5">5. Basic usage (Test Dependencies are already included on the device)</a></li>
<li><a class="el" href="group__ACE__TESTER__USER__GUIDE.html#ace_tester_section6">6. Advanced usage (Build and Flash through the test framework)</a></li>
<li><a class="el" href="group__ACE__TESTER__USER__GUIDE.html#ace_tester_section7">7. Setup for BT testing</a></li>
<li><a class="el" href="group__ACE__TESTER__USER__GUIDE.html#ace_tester_section8">8. Optional fields in task.json</a></li>
<li><a class="el" href="group__ACE__TESTER__USER__GUIDE.html#ace_tester_section9">9. Sharing results and Setting Baselines</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md8"></a>
ACE Tester</h1>
<p>ACE Tester is a unified host side test framework for ACE. The framework is written in Python and it's based on the standard Pytest framework. The tests are broken down into 2 core suites: the Device Porting Kit Test Suite (DTS) which includes tests at the Device Porting Kit (DPK) layer, and the Middleware Test Suite, which includes tests of all components within ACE. The main interface is the local_runner.py script which is included in this folder.</p>
<h1><a class="anchor" id="ace_tester_section1"></a>
1. Get ACE Tester</h1>
<p>ACE Tester is generally included by default in the ACE SDK package. Validate manually in the source tree to make sure this is the case. The ACE Tester is packaged into the following location "/ace/test/ace_tester/" of the build. Ensure that it's available before following this guide.</p>
<p>If ACE Tester is not present it can be added through the Configurator tool by including the ‘ace_tester’ module.</p>
<h1><a class="anchor" id="ace_tester_section2"></a>
2. Include test in the build</h1>
<h2><a class="anchor" id="autotoc_md9"></a>
Setting up the test environment</h2>
<p>To use ACE Tester follow the steps in this section to set up your environment. The guide is assuming you're using an Ubuntu based host machine based on a supported LTS version of the OS.</p>
<p>ACE Tester execution requires Python3.6 for execution. <a href="https://www.python.org/downloads/">https://www.python.org/downloads/</a> Verify that the Python3 environment is pointing to Python 3.6 by:</p>
<div class="fragment"><div class="line">$ python3 --version</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md10"></a>
Install Pytest</h2>
<p><a href="https://docs.pytest.org/en/latest/">Pytest</a> is the underlying framework that ACE Tester utilizes. It enables tests to be written without any boilerplate code and faster test development. </p><div class="fragment"><div class="line">$ python3 -m pip install pytest</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
Install Tox</h2>
<p><a href="https://tox.readthedocs.io/en/latest/">Tox</a> provides a convenient way to run the ACE Tester code in an isolated environment and manages the installation and versions of the Python packages </p><div class="fragment"><div class="line">$ python3 -m pip install tox</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md12"></a>
Install Pretty table</h2>
<p><a href="https://pypi.org/project/PrettyTable/">Pretty table</a> is used to visualize reports of test runs through the Command Line Interface (CLI) </p><div class="fragment"><div class="line">$ python3 -m pip install PrettyTable</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md13"></a>
Install lxml</h2>
<p><a href="https://lxml.de/index.html">lxml</a> is used internally for comparing test results against baselines. </p><div class="fragment"><div class="line">$ python3 -m pip install lxml</div></div><!-- fragment --><h1><a class="anchor" id="ace_tester_section3"></a>
3. Basic ACE Tester configurations</h1>
<p>All configurations of ACE Tester are set in the task.json file which is included in the root of ACE Tester folder. To run tests you need to configure a basic set of these parameters. The full list of parameters are documented in Section 8 of this document.</p>
<h2><a class="anchor" id="autotoc_md14"></a>
Set device serial number on the terminal</h2>
<p>If you're using a Device Serial Number integrated in the DeviceInfo component of ACE it's generally advised to let ACE Tester know which device you're testing by setting an environment variable.</p>
<div class="fragment"><div class="line">$ export DEVICE_SERIAL_NUMBER=&lt;serial-number&gt;</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md15"></a>
Wi-Fi</h2>
<p>Most of the tests included in ACE rely on a Wi-Fi connection. To set up Wi-Fi credentials you need to edit the task.json definition file. </p><div class="fragment"><div class="line">&quot;ssid&quot;: &quot;&quot;,                     // SSID of the 1st Wi-Fi Router (Mandatory)</div><div class="line">&quot;psk&quot;: &quot;&quot;,                      // PSK (Pre-Shared Key) of the 1st Wi-Fi Router (Mandatory)</div><div class="line">&quot;ssid2&quot;: &quot;&quot;,                    // Wi-Fi credentials for 2nd router (Optional)</div><div class="line">&quot;psk2&quot;: &quot;&quot;,                     // Wi-Fi credentials for 2nd router (Optional)</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md16"></a>
Account/Credentials</h2>
<p>In order to register the device and get access tokens ACE Tester needs the account login credentials. We advise to create temporary test accounts to run the tests. To add the Amazon credentials in task.json, edit the following fields in task.json: </p><div class="fragment"><div class="line">&quot;account_name&quot;: &quot;&quot;,             // Amazon account to which the device can be registered.</div><div class="line">                                // This would be required for testing ACE components like</div><div class="line">                                // FFS, Maplite, UsageStat, Metrics</div><div class="line">&quot;account_pwd&quot;: &quot;&quot;,              // Password for the Amazon Account</div></div><!-- fragment --><h1><a class="anchor" id="ace_tester_section4"></a>
4. Basic test setup validation</h1>
<p>The ACE Tester framework relies on serial communication with the device. The test suite leverages the standard ACE Command Line Interface (CLI) and it's also using a proprietary communication setup called the ACE Test Tunnel. So before starting to run real tests, it's important to ensure both communications channels work. The test runner provides a mechanism to validate the basic communication with the attached device for this.</p>
<div class="fragment"><div class="line"># Verify the sanity of device - test connectivity, reboot and the ATT communication protocol.</div><div class="line">$ python3 local_runner.py --verify-device-sanity --noflash</div></div><!-- fragment --><p>If these tests are not passing there's something missing in the basic configurations or the device communication. Investigate the error message, and make sure the device is connected to the host and the task.json configurations are accurately set.</p>
<h1><a class="anchor" id="ace_tester_section5"></a>
5. Basic usage (Test Dependencies are already included on the device)</h1>
<p>The most basic use-case of the framework is to run tests on a device which is connected to the host. In this basic model the test framework assumes all test dependencies are already part of the device. The "--noflash" flag needs to be specified when running this type of testing.</p>
<h2><a class="anchor" id="autotoc_md17"></a>
Listing test modules</h2>
<p>Test suites are referred to as modules by the script. The -l option lists available modules. </p><div class="fragment"><div class="line">$ python3 local_runner.py -l</div><div class="line"></div><div class="line">MODULES LIST:</div><div class="line">=============</div><div class="line">1. ACE_DTS_Mutex_Integration</div><div class="line">2. ACE_DTS_Semaphore_Integration</div><div class="line">3. ...</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md18"></a>
Execute a test module</h2>
<p>The following commands are used to run specific test suites/modules on the device. </p><div class="fragment"><div class="line"># Executing a single test suite</div><div class="line">$ python3 local_runner.py -m ACE_DTS_Mutex_Integration --noflash</div><div class="line"></div><div class="line"># Executing multiple test suites in one call</div><div class="line">$ python3 local_runner.py -m ACE_DTS_Mutex_Integration ACE_DTS_Semaphore_Integration --noflash</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md19"></a>
Execute a subset of test modules using wildcards and regex</h2>
<p>In addition the local_runner.py input accepts regex to select subsets of the test suites for the execution. </p><div class="fragment"><div class="line"># Executing all DTS integration tests</div><div class="line">$ python3 local_runner.py -m ACE_DTS.*Integration --noflash</div><div class="line"></div><div class="line"># Executing all MTS integration tests</div><div class="line">$ python3 local_runner.py -m ACE_MTS.*Integration --noflash</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md20"></a>
Results and Logs</h2>
<p>A high-level report of the test run gets published directly in the console, close to the end of the run. It's printed as a simple table of results on a per suite basis.</p>
<p>To get more details on the test run, every time local_runner.py is triggered, a new results directory created under the 'results' directory with the timestamp of the session.</p>
<p>The results directory includes a detailed HTML test report, and a full set of logs and artifacts captured during the test run. The results are intended to be used during debugging and analysis.</p>
<h2><a class="anchor" id="autotoc_md21"></a>
Optional arguments</h2>
<p>For more details on the extended list of arguments, here's the full help output from the tool:</p>
<div class="fragment"><div class="line">usage: local_runner.py [-h]</div><div class="line">                       (-l | --verify-test-setup | --verify-device-sanity | -m MODULES [MODULES ...] | --all)</div><div class="line">                       [--noflash] [--continue-on-setup-failure] [--stop-after-first-failure]</div><div class="line"></div><div class="line">Parsing the runner args</div><div class="line"></div><div class="line">optional arguments:</div><div class="line">  -h, --help            show this help message and exit</div><div class="line">  -l, --listmodules     list available test modules</div><div class="line">  --verify-test-setup   verify test setup by executing a list of tests</div><div class="line">  --verify-device-sanity</div><div class="line">                        verify device state by executing sanity tests</div><div class="line">  -m MODULES [MODULES ...], --modules MODULES [MODULES ...]</div><div class="line">                        executes a single module</div><div class="line">  --all                 executes all the modules from testcases.json</div><div class="line">  --noflash             run tests without flashing the device</div><div class="line">  --continue-on-setup-failure</div><div class="line">                        continue test execution even if build/flash fails</div><div class="line">  --suppress-script-output</div><div class="line">                        logs script to file</div><div class="line">  ---stop-after-first-failure</div><div class="line">                        stops test run after the first test failure</div></div><!-- fragment --><h1><a class="anchor" id="ace_tester_section6"></a>
6. Advanced usage (Build and Flash through the test framework)</h1>
<p>On devices with limited space in flash it may be necessary to do dedicated small test builds where only a limited number of test end points are added for each test suite. While this extends the overall runtime of the test suite it may be the only option on some devices. To be able to build dedicated test builds locally, the test dependencies in the firmware must first be enabled through a custom test build. The user must configure two scripts for generating a build and flashing that build to the device.</p>
<h2><a class="anchor" id="autotoc_md22"></a>
Build script</h2>
<p>In order for ACE Tester to be able to do builds, you need to supply a build script which hooks into the framework. The path to the build script is configured in task.json.</p>
<p>The default path is set to "util/scripts/build_script.sh":</p>
<div class="fragment"><div class="line">&quot;build_script&quot;: &quot;util/scripts/build_script.sh&quot;,</div></div><!-- fragment --><p>With the assumption that you're already able to build the source code on the host machine, the script generally will only be 2 lines. First, "cd" to the right directory, and then trigger the build command. For example something like this:</p>
<div class="fragment"><div class="line">$ cd &lt;absolute-path-of-ace-source-code&gt;</div><div class="line">$ BUILD_VENDOR=&lt;vendor&gt; BUILD_BOARD=&lt;board&gt; build.sh</div></div><!-- fragment --><p>Note: The script must have execute permissions.</p>
<h2><a class="anchor" id="autotoc_md23"></a>
Flash script</h2>
<p>Similarly, commands also need to be added to flash the device with the image which was built using the build script. This script will also generally only be 2 lines. First, "cd" to the right directory where the build artifacts are located and trigger the custom flash tools you're using for the project. For example something like this:</p>
<div class="fragment"><div class="line">$ cd &lt;absolute-path-of-flashimage-script&gt;</div><div class="line">$ python3 flashimage.py --port &lt;device-path&gt;</div></div><!-- fragment --><p> Note: The script must have execute permissions.</p>
<h2><a class="anchor" id="autotoc_md24"></a>
Configure the ace_path</h2>
<p>The ace_path needs to be set up for you to be able to generate custom test builds. The ACE Tester framework needs the absolute path to your SDK. </p><div class="fragment"><div class="line">&quot;ace_path&quot;: &quot;&quot;,                                           // Path to the ACE SDK folder (Optional)</div><div class="line">&quot;project_path&quot;: &quot;&quot;,                                       // Path to a specific project/app (Optional)</div><div class="line">&quot;build_script&quot;: &quot;util/scripts/build_script.sh&quot;,           // Relative/Absolute path to the build script (Optional)</div><div class="line">&quot;flash_script&quot;: &quot;util/scripts/flash_script.sh&quot;,           // Relative/Absolute Path to the flash script (Optional)</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md25"></a>
Validate the test setup</h2>
<p>Validate test setup including build scripts, flash scripts and python dependencies. </p><div class="fragment"><div class="line">$ python3 local_runner.py --verify-test-setup</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md26"></a>
Run the full test suite</h2>
<p>This command goes through all the test suites in the framework 1-by-1 doing a build and flash for each suite: </p><div class="fragment"><div class="line">$ python3 local_runner.py --all</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md27"></a>
Run all DTS integration tests</h2>
<p>It's also possible to run a subset of tests using wildcards. As an example this command runs all DTS tests: </p><div class="fragment"><div class="line">$ python3 local_runner.py -m ACE_DTS.*</div></div><!-- fragment --><h1><a class="anchor" id="ace_tester_section7"></a>
7. Setup for BT testing</h1>
<p>Bluetooth (BT) testing requires a Raspberry PI 3 device to be connected to the host PC. The setup of this device is relatively trivial. It needs to have SSH enabled and there are a couple of dependencies which need to be installed through apt-get.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
Equipment</h2>
<ul>
<li><a href="https://www.amazon.com/CanaKit-Raspberry-Power-Supply-Listed/dp/B07BC6WH7V/ref=sr_1_8?crid=2LIQXN5ORSY6F&amp;keywords=raspberry+pi+3b%2B+kit&amp;qid=1550620484&amp;s=gateway&amp;sprefix=Raspberry+PI+3b%2B%2Caps%2C185&amp;sr=8-8">Raspberry Pi 3 B+ and Power Supply</a></li>
<li>MicroSD card: (You can buy it from this link: <a href="https://www.amazon.com/dp/B073JWXGNT/ref=twister_B07B3MFBHY?_encoding=UTF8&amp;psc=1">SDCard</a> )</li>
<li>Ethernet cable for connectivity<ul>
<li>(Or can set-up Wi-Fi following the instructions https://www.raspberrypi.org/documentation/configuration/wireless/wireless-cli.md "here")</li>
</ul>
</li>
<li>Monitor, HDMI cable and keyboard (for the initial Raspberry Pi set-up purposes)</li>
</ul>
<h2><a class="anchor" id="autotoc_md29"></a>
Update the Raspbian OS (Optional)</h2>
<p>Raspberry Pis come with Raspbian installed out of the box. This section is included for reference on how to get and update the OS should there be a need for this. Tools for updating the OS can be downloaded from <a href="https://www.raspberrypi.org/downloads/raspbian/">here</a>, and instructions on how to flash the Raspbian image can be found https://www.raspberrypi.org/documentation/installation/installing-images/README.md "here".</p>
<h2><a class="anchor" id="autotoc_md30"></a>
Enable SSH on the Raspberry Pi</h2>
<h3><a class="anchor" id="autotoc_md31"></a>
Connect the monitor and keyboard to the Raspberry Pi</h3>
<p>Connect the monitor and keyboard to the Raspberry Pi, and login</p>
<ul>
<li>Default login: pi</li>
<li>Default password: raspberry</li>
</ul>
<h3><a class="anchor" id="autotoc_md32"></a>
Set the correct Country and timezone (necessary to use Wi-Fi)</h3>
<ul>
<li>For desktop versions, follow the prompts.</li>
<li>For command line version, use "sudo raspi-config" to set it up.</li>
<li>More info for setting up Wi-Fi on command line version can be found https://www.raspberrypi.org/documentation/configuration/wireless/wireless-cli.md "here".</li>
</ul>
<h3><a class="anchor" id="autotoc_md33"></a>
Enable SSH</h3>
<p>Use the below two commands for Enabling SSH</p>
<div class="fragment"><div class="line">$ sudo systemctl enable ssh</div><div class="line">$ sudo systemctl start ssh</div></div><!-- fragment --><h3><a class="anchor" id="autotoc_md34"></a>
Retrieve IP address of the Raspberry Pi</h3>
<p>Use either of these commands to get and note down the IP address of RPI:</p>
<div class="fragment"><div class="line">$ ifconfig</div><div class="line">$ hostname -I</div></div><!-- fragment --><h3><a class="anchor" id="autotoc_md35"></a>
Install dependencies</h3>
<p>Install the following dependencies on your Raspberry PI to support all types of test in ACE Tester.</p>
<div class="fragment"><div class="line">$ sudo apt-get update</div><div class="line">$ sudo apt-get install -y libusb-dev libdbus-1-dev libglib2.0-dev libudev-dev libical-dev libreadline-dev python-dbus</div></div><!-- fragment --><h3><a class="anchor" id="autotoc_md36"></a>
Versioning requirement for BlueZ</h3>
<p>Check the current version of BlueZ installed on your Raspberry Pi by using this command: </p><div class="fragment"><div class="line">$ bluetoothd --version</div></div><!-- fragment --><p>If version 5.37 or higher is already installed, you are done with the configurations needed on the Raspberry Pi, and can move on to the next section.</p>
<ul>
<li>To install BlueZ to your Raspberry Pi, go to <a href="http://www.bluez.org/">http://www.bluez.org/</a> to download the latest version of BlueZ Bluetooth protocol Stack</li>
<li>Extract the contents of the file</li>
<li>Go to the corresponding directory to install BlueZ</li>
</ul>
<p>How to update/Install Bluez: </p><div class="fragment"><div class="line">$ cd bluez-x.xx</div><div class="line">$ ./configure</div><div class="line">$ make</div><div class="line">$ sudo make install</div></div><!-- fragment --><h3><a class="anchor" id="autotoc_md37"></a>
Update task.json with the Raspberry Pi information for BT testing</h3>
<p>The last step in order to run the BT tests is to update the task.json with the information you gathered as you were configuring the device. There are currently 3 test sections in the task.json file which needs to be set.</p>
<p>The BLE DPK level test suite uses this section: </p><div class="fragment"><div class="line">&quot;ble_hal&quot;: {</div><div class="line">  &quot;uname&quot;: &quot;&lt;your username: default:pi&gt;&quot;,</div><div class="line">  &quot;ip&quot;: &quot;&lt;your IP&gt;&quot;,</div><div class="line">  &quot;password&quot;: &quot;&lt;your password: default:raspberry&gt;&quot;</div><div class="line">},</div></div><!-- fragment --><p>The BT Middleware test suite uses this section: </p><div class="fragment"><div class="line">&quot;rpi&quot;: {</div><div class="line">    &quot;rpi_ip&quot;: &quot;&lt;your IP&gt;&quot;,</div><div class="line">    &quot;rpi_user_name&quot;: &quot;&lt;your username: default:pi&gt;&quot;,</div><div class="line">    &quot;rpi_password&quot;: &quot;&lt;your password: default:raspberry&gt;&quot;,</div><div class="line">    &quot;set_mtu&quot;: 48</div><div class="line">},</div></div><!-- fragment --><p>The Wi-Fi COEX test suite uses this section: </p><div class="fragment"><div class="line">&quot;wifi&quot;: {</div><div class="line">  &quot;setup&quot;: {</div><div class="line">    &quot;RASP_PI&quot;: {</div><div class="line">      &quot;uname&quot;: &quot;&lt;your username: default:pi&gt;&quot;,</div><div class="line">      &quot;pwd&quot;: &quot;&lt;your password: default:raspberry&gt;&quot;,</div><div class="line">      &quot;ip&quot;: &quot;&lt;your IP&gt;&quot;</div><div class="line">    }</div><div class="line">  },</div></div><!-- fragment --><h3><a class="anchor" id="autotoc_md38"></a>
Run the BT tests</h3>
<p>Before running the tests we advise logging in manually once through SSH from the host machine. To do this both the host and the Raspberry Pi need to be connected to the same network.</p>
<p>Then, as a first step before running the full suite of BT and Wi-Fi tests we suggest to start with the following simple test of a single advertisement: </p><div class="fragment"><div class="line">$ cd acetest</div><div class="line">$ tox -- tests/middleware/bluetooth/host/ble_functional/test_ble_functional.py::TestBLEStartSingleAdvertisement</div></div><!-- fragment --><p>To run all the BT test cases use these commands: </p><div class="fragment"><div class="line">$ cd acetest</div><div class="line">$ tox tests/middleware/bluetooth/</div></div><!-- fragment --><p>To run all the Wi-Fi test cases use these commands: </p><div class="fragment"><div class="line">$ cd acetest</div><div class="line">$ tox tests/middleware/wifi/</div></div><!-- fragment --><h1><a class="anchor" id="ace_tester_section8"></a>
8. Optional fields in task.json</h1>
<p>The task.json file in the ace_tester directory is the main configuration file used by the framework. Before running tests it's advised to familiarize yourself with the high-level parameters which are included in the file.</p>
<div class="fragment"><div class="line">{</div><div class="line">  &quot;config&quot;: {</div><div class="line">    &quot;build&quot;: {</div><div class="line">      &quot;ace_path&quot;: &quot;&quot;,                                           // Path to the ACE SDK folder (Optional)</div><div class="line">      &quot;project_path&quot;: &quot;&quot;,                                       // Path to a specific project/app (Optional)</div><div class="line">      &quot;build_script&quot;: &quot;util/scripts/build_script.sh&quot;,           // Relative/Absolute path to the build script (Optional)</div><div class="line">      &quot;flash_script&quot;: &quot;util/scripts/flash_script.sh&quot;,           // Relative/Absolute Path to the flash script (Optional)</div><div class="line">      &quot;relay_board_port&quot;: &quot;&quot;,                                   // Port of relay board that can be used to recover or</div><div class="line">                                                                //   flash devices (Optional)</div><div class="line">      &quot;relay_script_path&quot;: &quot;&quot;,                                  // If a relay board port is provided, it should be</div><div class="line">                                                                //   accompanied by a corresponding script to be used</div><div class="line">                                                                //   for device recovery (Optional)</div><div class="line">      &quot;reset_command&quot;: &quot;&quot;                                       // Optional argument to the above script to indicate</div><div class="line">                                                                //   reboot (Optional)</div><div class="line">    },</div><div class="line">    &quot;ssid&quot;: &quot;&quot;,                                                 // SSID of the 1st Wi-Fi Router (Mandatory)</div><div class="line">    &quot;psk&quot;: &quot;&quot;,                                                  // PSK (Pre-Shared Key) of the 1st Wi-Fi Router (Mandatory)</div><div class="line">    &quot;ssid2&quot;: &quot;&quot;,                                                // Wi-Fi credentials for 2nd router (Optional)</div><div class="line">    &quot;psk2&quot;: &quot;&quot;,                                                 // Wi-Fi credentials for 2nd router (Optional)</div><div class="line">    &quot;account_name&quot;: &quot;&quot;,                                         // Amazon account to which the device can be registered.</div><div class="line">                                                                //   This would be required for testing ACE components like</div><div class="line">                                                                //   FFS, Maplite, UsageStat, Metrics</div><div class="line">    &quot;retry_test_count&quot;: 3,                                      // Number of times tests are re-run when the result</div><div class="line">                                                                //   parser reports an incorrect number of tests.</div><div class="line">    &quot;account_pwd&quot;: &quot;&quot;,                                          // Password for the Amazon Account</div><div class="line">    &quot;ffs&quot;:{                                                     // Refer to &#39;Setup for FFS testing&#39; for setting up</div><div class="line">      &quot;ugs_provisioner_dsn&quot;:&quot;&quot;,                                 //   the companion device for registering through FFS</div><div class="line">      &quot;zts_provisioner_dsn&quot;: &quot;&quot;                                 //   and getting the Device Serial Number of the</div><div class="line">    },                                                          //   companion device</div><div class="line">    &quot;acm&quot;:{</div><div class="line">      &quot;http_server&quot;: &quot;&quot;</div><div class="line">    },</div><div class="line">    &quot;ble_hal&quot;: {                                                // Raspberry Pi credentials and BLE DPK testing</div><div class="line">      &quot;uname&quot;: &quot;&quot;,                                              //   Refer to &#39;Setup for BT testing&#39; to setup the companion</div><div class="line">      &quot;ip&quot;: &quot;&quot;,                                                 //   device. Then fill the ip, user name (uname) and password</div><div class="line">      &quot;password&quot;: &quot;&quot;</div><div class="line">    },</div><div class="line">    &quot;bluetooth&quot;: {</div><div class="line">      &quot;adapter_name&quot;: &quot;&quot;,</div><div class="line">      &quot;stress_iterations&quot;: 100,</div><div class="line">      &quot;stress_pass_percentage&quot;: 100,</div><div class="line">      &quot;stress_adv_scan_interval_in_mins&quot;: 10,</div><div class="line">      &quot;stress_adv_scan_total_time_in_mins&quot;: 40,</div><div class="line">      &quot;stress_adv_sleep_time_in_secs&quot;: 120,</div><div class="line">      &quot;uuid_type&quot;: &quot;16&quot;,</div><div class="line">      &quot;service_type&quot;: &quot;0&quot;,</div><div class="line">      &quot;beacon&quot;: {</div><div class="line">        &quot;adv_connectable&quot;: 1,</div><div class="line">        &quot;adv_enable_privacy&quot;: 0,</div><div class="line">        &quot;adv_timeout&quot;: 120,</div><div class="line">        &quot;adv_priority&quot;: 0,</div><div class="line">        &quot;adv_mode&quot;: 0,</div><div class="line">        &quot;adv_preferred_interval&quot;: 0,</div><div class="line">        &quot;adv_qos_preference&quot;: 0,</div><div class="line">        &quot;client_id&quot;: &quot;0&quot;,</div><div class="line">        &quot;beacon_data_uuid_type&quot;: &quot;16&quot;,</div><div class="line">        &quot;beacon_data_service_data&quot;: &quot;004cA495991b7852b855&quot;,</div><div class="line">        &quot;beacon_data_service_data_length&quot;: 10</div><div class="line">      },</div><div class="line">      &quot;addchar&quot;: {</div><div class="line">        &quot;add_char_property&quot;: &quot;a&quot;,</div><div class="line">        &quot;add_char_permission&quot;: &quot;11&quot;,</div><div class="line">        &quot;add_char_format&quot;: &quot;11&quot;,</div><div class="line">        &quot;add_char_uuid_type&quot;: &quot;128&quot;</div><div class="line">      },</div><div class="line">      &quot;addchardesc&quot;: {</div><div class="line">        &quot;add_char_desc_permission&quot;: &quot;11&quot;,</div><div class="line">        &quot;add_char_desc_uuid_type&quot;: &quot;128&quot;</div><div class="line">      },</div><div class="line">      &quot;sendnotify&quot;: {</div><div class="line">        &quot;send_notify_char_uuid_or_handle&quot;: &quot;3&quot;,</div><div class="line">        &quot;send_notify_length&quot;: &quot;1&quot;,</div><div class="line">        &quot;send_notify_hex_value&quot;: &quot;12&quot;</div><div class="line">      },</div><div class="line">      &quot;connpriority&quot;: {</div><div class="line">        &quot;conn_priority&quot;: &quot;0&quot;</div><div class="line">      }</div><div class="line">    },</div><div class="line">    &quot;rpi&quot;: {                                                    // Raspberry Pi credentials and BT Middleware testing</div><div class="line">        &quot;rpi_ip&quot;: &quot;&quot;,                                           //   Refer to &#39;Setup for BT testing&#39; to setup the companion</div><div class="line">        &quot;rpi_user_name&quot;: &quot;&quot;,                                    //   device. Then fill the ip, user name (uname) and password</div><div class="line">        &quot;rpi_password&quot;: &quot;&quot;,</div><div class="line">        &quot;set_mtu&quot;: 48</div><div class="line">    },</div><div class="line">    &quot;wifi&quot;: {</div><div class="line">      &quot;setup&quot;: {                                                // Raspberry Pi credentials and IP for Coex testing</div><div class="line">        &quot;RASP_PI&quot;: {                                            //   Refer to &#39;Setup for BT testing&#39; to setup the companion</div><div class="line">          &quot;uname&quot;: &quot;&quot;,                                          //   device. Then fill the ip, user name (uname) and password</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;ip&quot;: &quot;&quot;</div><div class="line">        }</div><div class="line">      },</div><div class="line">      &quot;stress&quot; : {</div><div class="line">        &quot;stress_iterations&quot; : 5,</div><div class="line">        &quot;stress_pass_percentage&quot; : 95</div><div class="line">      },</div><div class="line">      &quot;profiles&quot; : {</div><div class="line">        &quot;WPA2_AES&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;WEP_OPEN_64_HEX&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WEP&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;WEP_SHARED_64_HEX&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WEP&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;WPA2_AES_HIDDEN&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WPA2&quot;,</div><div class="line">          &quot;hidden&quot;: 1</div><div class="line">        },</div><div class="line">        &quot;WEP_SHARED_64_ASCII&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WEP&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;WEP_OPEN_64_ASCII&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WEP&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;WEP_SHARED_128_ASCII&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WEP&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;WEP_OPEN_128_ASCII&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WEP&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;WEP_SHARED_128_HEX&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WEP&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;WEP_OPEN_128_HEX&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WEP&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;WPA_TKIP&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WPA&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;OPEN&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;Open&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;SPL_SSID&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;&quot;,</div><div class="line">          &quot;security&quot;: &quot;WPA2&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        },</div><div class="line">        &quot;NO_DHCP&quot;: {</div><div class="line">          &quot;ssid&quot;: &quot;SSID_NO_DHCP&quot;,</div><div class="line">          &quot;pwd&quot;: &quot;12345678&quot;,</div><div class="line">          &quot;security&quot;: &quot;WPA2&quot;,</div><div class="line">          &quot;hidden&quot;: 0</div><div class="line">        }</div><div class="line">      },</div><div class="line">      &quot;scan&quot;: {</div><div class="line">        &quot;min_scanned_devices&quot;: 1</div><div class="line">      },</div><div class="line">      &quot;stress_iterations&quot;: 100,</div><div class="line">      &quot;stress_pass_percentage&quot;: 100</div><div class="line">    },</div><div class="line">    &quot;audio&quot;: {                                                  // Set the propety &#39;jack&#39; to &#39;1&#39; if the device under</div><div class="line">      &quot;jack&quot;: 0                                                 // test supports an audio jack. &#39;0&#39; otherwise</div><div class="line">    },</div><div class="line">    &quot;device_info_data&quot;: {</div><div class="line">      &quot;OS_VERSION&quot;: &quot;0&quot;,</div><div class="line">      &quot;VERSION_NUMBER&quot;: &quot;0&quot;,</div><div class="line">      &quot;BUILD_FINGERPRINT&quot;: &quot;&quot;,</div><div class="line">      &quot;PRODUCT_NAME&quot;: &quot;aaaa&quot;,                                   // Name of the product</div><div class="line">      &quot;BUILD_VARIANT&quot;: &quot;bbbb&quot;,                                  // Build variant used</div><div class="line">      &quot;BUILD_TAGS&quot;: &quot;&quot;,</div><div class="line">      &quot;PACKAGE_NAME&quot;: &quot;&quot;,</div><div class="line">      &quot;HARDWARE_NAME&quot;: &quot;cccc&quot;,                                  // Name of the HW used</div><div class="line">      &quot;BOOTLOADER&quot;: &quot;&quot;,</div><div class="line">      &quot;DEVICE_SERIAL&quot;: &quot;dddd&quot;,</div><div class="line">      &quot;DEVICE_TYPE_ID&quot;: &quot;0&quot;,</div><div class="line">      &quot;WIFI_MAC&quot;: &quot;0&quot;,</div><div class="line">      &quot;BT_MAC&quot;: &quot;0&quot;,</div><div class="line">      &quot;MANUFACTURING&quot;: &quot;amazon&quot;,                                // Manufacturer name</div><div class="line">      &quot;PRODUCT_ID&quot;: &quot;&quot;,</div><div class="line">      &quot;FFS_PIN&quot;: &quot;&quot;,</div><div class="line">      &quot;DEV_HW_REV&quot;: &quot;&quot;,</div><div class="line">      &quot;DSS_PUB_KEY&quot;: &quot;&quot;,</div><div class="line">      &quot;SIGN_TYPE&quot;: &quot;&quot;,</div><div class="line">      &quot;DEVICEID&quot;: &quot;&quot;,</div><div class="line">      &quot;BOARDID&quot;: &quot;&quot;,</div><div class="line">      &quot;MFGNAME&quot;: &quot;amazon&quot;,</div><div class="line">      &quot;PLATFORM_NAME&quot;: &quot;&quot;,</div><div class="line">      &quot;BT_DEVICE_NAME&quot;: &quot;eeee&quot;                                  // Bluetooth adv device name</div><div class="line">    }</div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><h1><a class="anchor" id="ace_tester_section9"></a>
9. Sharing results and Setting Baselines</h1>
<p>Baselines can be generated and compared against future test runs to report any differing test results. Upon generation, baseline data are automatically saved to the 'baselines' directory with the timestamp of the session.</p>
<h2><a class="anchor" id="autotoc_md39"></a>
Generating baselines</h2>
<p>The following command stores the current test results as a baseline for future comparisons. </p><div class="fragment"><div class="line">$ python3 local_runner.py -m ACE_DTS_.* --generate-baseline</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md40"></a>
Comparing a baseline against a test run</h2>
<p>This command compares the results between the current run and the baseline </p><div class="fragment"><div class="line">$ python3 local_runner.py -m ACE_DTS_.* --compare-against-baseline baselines/[timestamped-baseline]</div></div><!-- fragment --><h2><a class="anchor" id="autotoc_md41"></a>
Comparing two baseline or result folders against each other</h2>
<p>It's also possible to directly compare baselines. This is especially useful when developing on experimental platforms or code from Amazon, where all tests are not yet passing. </p><div class="fragment"><div class="line"># Comparing a test result against a baseline</div><div class="line">$ python3 local_runner.py --compare-baseline baselines/[timestamped-baseline] results/[timestamped-test-results]</div><div class="line"># Or comparing two baselines:</div><div class="line">$ python3 local_runner.py --compare-baseline baselines/[timestamped-baseline-1] baseline/[timestamped-baseline-2]</div></div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
