<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACS: LOG Porting Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ACS
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__LOG__PORTING__GUIDE.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">LOG Porting Guide<div class="ingroups"><a class="el" href="group__ACS__CORE__DOCS.html">ACS Core Docs</a> &raquo; <a class="el" href="group__PORTING__GUIDE.html">DPK Porting Guides</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for LOG Porting Guide:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__LOG__PORTING__GUIDE.png" border="0" alt="" usemap="#group____LOG____PORTING____GUIDE"/>
<map name="group____LOG____PORTING____GUIDE" id="group____LOG____PORTING____GUIDE">
<area shape="rect" id="node2" href="group__PORTING__GUIDE.html" title="DPK Porting Guides" alt="" coords="5,5,145,32"/>
</map>
</td></tr></table></center>
</div>
<ul>
<li><a class="el" href="group__LOG__PORTING__GUIDE.html#log_port_1">Background</a></li>
<li><a class="el" href="group__LOG__PORTING__GUIDE.html#log_port_2">Scope</a></li>
<li><a class="el" href="group__LOG__PORTING__GUIDE.html#log_port_3">Porting prerequisites</a></li>
<li><a class="el" href="group__LOG__PORTING__GUIDE.html#log_port_4">Rules and limits</a></li>
<li><a class="el" href="group__LOG__PORTING__GUIDE.html#log_port_5">Implementation details</a></li>
<li><a class="el" href="group__LOG__PORTING__GUIDE.html#log_port_6">Testing</a></li>
<li><a class="el" href="group__LOG__PORTING__GUIDE.html#log_port_7">Implementation example</a></li>
<li><a class="el" href="group__LOG__PORTING__GUIDE.html#log_port_8">Guidance</a></li>
</ul>
<h1><a class="anchor" id="log_port_1"></a>
Background</h1>
<p>ACS includes a logging framework allowing applications to write logs to a central repository. By using ACE_LOG, applications can specify log buffer ID, severity level, and tag when writing the log. The ACS logging module will pass logs to the platform through the <a class="el" href="group__ACE__HAL__LOG.html">Log</a> API. The platform implementation handles the final log processing and log buffer management. How the user accesses and retrieves the log in the central repository in the platform depends on the platform implementation. This document provides information for the platform developers to develop the required components to support ACS logging framework.</p>
<p>The logging framework includes three layers:</p><ul>
<li>Applications that write or read logs using the ACE_LOG .</li>
<li>ace_log module which implements ACE_LOG on top of <a class="el" href="group__ACE__HAL__LOG.html">Log</a> API.</li>
<li>The platform implementation which includes the <a class="el" href="group__ACE__HAL__LOG.html">Log</a> API implementation, log buffer management, and storage management.</li>
</ul>
<p>When an application writes a log through ACE_LOG, it passes through following steps:</p><ol type="1">
<li>Application writes log using ACE_LOG .</li>
<li>ACS logging module checks the log against the filtering rules such as log severity. If it passes, it proceeds to the next step.</li>
<li>ACS logging module forwards the message to platform through <a class="el" href="group__ACE__HAL__LOG.html">Log</a> API.</li>
<li>Platform implementation of <a class="el" href="group__ACE__HAL__LOG.html">Log</a> API adds the log to the designated log buffer based on the buffer ID, adding metadata such as tag, severity level, timestamp, etc.</li>
<li>Platform also manages log buffers to keep the log buffers or file sizes from exceeding the designated size. Platform can optionally archive older logs.</li>
</ol>
<p>The implementation of ACE_LOG are included in the ACS. The implementation of <a class="el" href="group__ACE__HAL__LOG.html">Log</a> API and the support for the final log handling, storage and log buffer management are to be implemented by each platform according to their requirements.</p>
<h1><a class="anchor" id="log_port_2"></a>
Scope</h1>
<p>ACS provides the platform-independent support for the functionalities in steps 1, 2 and 3 mentioned in the <a class="el" href="group__LOG__PORTING__GUIDE.html#log_port_1">Background</a>. The platform needs to provide support for the functionalities in steps 4 and 5 for the logging framework to be complete. It's up to the platform developer to decide the approach to support this feature. Because the platform resources and needs vary from platform to platform, the implementation to support these functions also varies accordingly. The platform developer is free to choose how to support these functionalities.</p>
<p>The following features are beyond the scope of this porting guide, but should be supported by the platform implementation to make the logging system complete:</p><ul>
<li>Log buffer management so applications can continue writing logs without causing the log storage to exceed the designed size.<br />
</li>
<li>Log buffer or file access so the user can review and retrieve logs.</li>
</ul>
<h1><a class="anchor" id="log_port_3"></a>
Porting prerequisites</h1>
<ol type="1">
<li>A storage or filesystem supporting read and write operations.</li>
<li>The storage or filesystem should be able to support write/read throughout the designed life of the device.</li>
</ol>
<h1><a class="anchor" id="log_port_4"></a>
Rules and limits</h1>
<p>On a platform that supports multiple threads, the implementation needs to be thread-safe. On a platform that supports multiple processes, the implementation should support logging operations from multiple processes. Unless the API is specified as a blocking call, all API implementation should return quickly and block as little as possible.</p>
<h1><a class="anchor" id="log_port_5"></a>
Implementation details</h1>
<p>These are the APIs to be implemented by Logging HAL:<br />
</p>
<ul>
<li><a class="el" href="group__ACE__HAL__LOG__APIs.html#gae9251db3eccfea40238d4ab6f53b6ba5">aceLogHal_getPlatformProperty()</a></li>
<li><a class="el" href="group__ACE__HAL__LOG__APIs.html#gac75b4b4095b4803f34acbbaf0b2077ee">aceLogHal_write()</a></li>
<li><a class="el" href="group__ACE__HAL__LOG__APIs.html#ga21d5ddf80b24f7401481bc5ee81f778a">aceLogHal_readOpen()</a></li>
<li><a class="el" href="group__ACE__HAL__LOG__APIs.html#ga225fb3ba78948fe6a30a79d52c59603b">aceLogHal_read()</a></li>
<li><a class="el" href="group__ACE__HAL__LOG__APIs.html#gabaf115901c130e1c662a5f986c31896e">aceLogHal_readClose()</a></li>
</ul>
<p>Shared library name: libacehal_log</p>
<p>For detailed information on individual APIs, please refer to the <a class="el" href="group__ACE__HAL__LOG.html">API documentation</a>.</p>
<h1><a class="anchor" id="log_port_6"></a>
Testing</h1>
<p>The platform developer can reference ACE_HAL_TESTS_LOG for <a class="el" href="group__ACE__HAL__LOG.html">Log</a> implementation testing.</p>
<h1><a class="anchor" id="log_port_7"></a>
Implementation example</h1>
<p>On Linux platforms, rsyslog provides log storage and management. The platform may leverage it to implement</p><ul>
<li><a class="el" href="group__ACE__HAL__LOG.html">Log</a> <br />
</li>
<li><a class="el" href="group__ACE__HAL__LOG__APIs.html#gac75b4b4095b4803f34acbbaf0b2077ee" title="Write a text or binary log. ">aceLogHal_write()</a> can be implemented using syslog().<br />
</li>
<li><a class="el" href="group__ACE__HAL__LOG__APIs.html#ga225fb3ba78948fe6a30a79d52c59603b" title="Read one or multiple formatted text log entry or one binary log message. Read should begin with the h...">aceLogHal_read()</a> can be implemented by reading log files.<br />
</li>
<li>Buffer IDs are mapped to facility codes.<br />
</li>
<li>Log rotation can be done by using logrotate.<br />
</li>
</ul>
<p>On the Android platform, the platform can leverage Android's logd module to implement <a class="el" href="group__ACE__HAL__LOG.html">Log</a>.</p>
<h1><a class="anchor" id="log_port_8"></a>
Guidance</h1>
<p>The implementation should manage log storage so it will never exceed the allocated storage space. It can be done through log buffer rotation, purging, archiving, etc.</p>
<p>ACS Logging framework does not specify log format requirements, but the platform implementation should consider the requirement from the log consumers and format accordingly. </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
