<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ACS: Wi-Fi</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ACS
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__WIFI__PORTING__GUIDE.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Wi-Fi<div class="ingroups"><a class="el" href="group__ACS__CORE__DOCS.html">ACS Core Docs</a> &raquo; <a class="el" href="group__PORTING__GUIDE.html">DPK Porting Guides</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Wi-Fi:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__WIFI__PORTING__GUIDE.png" border="0" alt="" usemap="#group____WIFI____PORTING____GUIDE"/>
<map name="group____WIFI____PORTING____GUIDE" id="group____WIFI____PORTING____GUIDE">
<area shape="rect" id="node2" href="group__PORTING__GUIDE.html" title="DPK Porting Guides" alt="" coords="5,5,145,32"/>
</map>
</td></tr></table></center>
</div>
<ul>
<li><a class="el" href="group__WIFI__PORTING__GUIDE.html#wifi_background">Introduction</a></li>
<li><a class="el" href="group__WIFI__PORTING__GUIDE.html#wifi_getting_started">Dependencies</a></li>
<li><a class="el" href="group__WIFI__PORTING__GUIDE.html#wifi_guidance">Usage/Best Practices</a><ul>
<li><a class="el" href="group__WIFI__PORTING__GUIDE.html#wifi_guidance_api">API Guidance</a></li>
</ul>
</li>
<li><a class="el" href="group__WIFI__PORTING__GUIDE.html#wifi_example">Implementation example</a><ul>
<li><a class="el" href="group__WIFI__PORTING__GUIDE.html#wifi_example_overall">Example of Wi-Fi Init Calling Flow.</a></li>
<li><a class="el" href="group__WIFI__PORTING__GUIDE.html#wifi_example_connect">Example of Flow Control for Connecting to API</a></li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="wifi_background"></a>
Introduction</h1>
<p>The ACS Wi-Fi HAL provides the hardware platform abstraction layer for Wi-Fi. This guide provides onboarding guidelines for Wi-Fi chip vendors who are developing on the ACS-based platform.</p>
<h1><a class="anchor" id="wifi_getting_started"></a>
Dependencies</h1>
<p>The vendor HAL implementation should support the basic Wi-Fi functionalities, such as Wi-Fi scan/connect/disconnect/softAP. <br />
 The basic Wi-Fi feature APIs are listed in <a class="el" href="group__WIFI__PORTING__GUIDE.html#wifi_guidance_api">API Guidance</a>. <br />
 In addition to the basic common Wi-Fi feature support, vendor HAL implementation should cover: <br />
</p><ul>
<li>Wi-Fi profile management <br />
 Wi-Fi profiles are maintained in the HAL layer. The HAL implementation should support add/remove/save/load Wi-Fi profiles. Vendor can choose to use ACS KVS storage for profile storage. Refer to <a class="el" href="group__KV__STORAGE__PORTING__GUIDE.html">KV Storage</a> for further info about ACS KVS storage. <br />
 The HAL implementation should be able to manage the number of profiles defined in the ACS feature config - ACE_WIFI_MAX_CONFIGURED_NETWORKS. <br />
 The HAL implementation should be able to enable/disable profiles.</li>
<li>Auto connect <br />
 Currently, Wi-Fi auto connect is triggered by the HAL implementation, during device reboot and Wi-Fi disconnection.</li>
<li>Scan results <br />
 ACS scan request is done in an asynchronous way. Thus the HAL implementation should have the ability to store full scan results, and return scan results upon request.</li>
<li>DHCP <br />
 The HAL implementation should be able to obtain an IP address through DHCP.</li>
</ul>
<h1><a class="anchor" id="wifi_guidance"></a>
Usage/Best Practices</h1>
<p>In general, Wi-Fi chip vendors need to support the API in <a class="el" href="group__WIFI__PORTING__GUIDE.html#wifi_guidance_api">API Guidance</a>, to provide Wi-Fi functionalities needed by the Wi-Fi middleware.</p>
<div class="image">
<img src="wifi_porting_overall.jpg" alt="wifi_porting_overall.jpg"/>
</div>
<p>The HAL implementation provides support dependent on the platform (Linux, RTOS) and the Wi-Fi chip vendor.</p>
<p>On a Linux system, a typical HAL implementation includes interactions with wpa_supplicant and DHCP components.</p>
<p>On an RTOS system, a typical HAL implementation includes interactions with RTOS lwip. <br />
 Wi-Fi HAL implementation can also be split into two layers, where the lower layer can use Amazon AWS FreeRTOS Wi-Fi API:<br />
 <a href="https://github.com/aws/amazon-freertos/tree/master/libraries/abstractions/wifi">https://github.com/aws/amazon-freertos/tree/master/libraries/abstractions/wifi</a> <br />
 Vendors can contact an Amazon ACS representative, if interested in using AWS Wi-Fi API instead for RTOS Wi-Fi HAL implementation. <br />
</p>
<p>Shared library name: libacehal_wifi</p>
<h1><a class="anchor" id="wifi_guidance_api"></a>
API Guidance</h1>
<p>APIs defined in ace/hal_wifi.h are used by Wi-Fi middleware for Wi-Fi functionality support. The APIs listed below are mandatory for common Wi-Fi support:</p>
<ul>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga154101eacf55b5ffb760ff3a310cfb6c">aceWifiHal_init</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gacac83a345e569bfdda353dd0c87c6aec">aceWifiHal_deinit</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga4c91a5ba993acda4537fd5033c6298c6">aceWifiHal_start</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga5741d20925f757a747ac0a49d64474c6">aceWifiHal_startScan</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga19c142a52e27c3752181cf626f2907e5">aceWifiHal_addNetwork</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga4a21bac314f348a8ab1dd2aaa35d49a0">aceWifiHal_removeNetwork</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga503f24c212f034d0d2a6149d412870db">aceWifiHal_saveConfig</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga808dd87c5c895ee0fc0f8805e263a9af">aceWifiHal_connect</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga7a6c75f9edb57edb7842dfa5af9c9015">aceWifiHal_disconnect</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga788c060c50020d10f9c6d2cba655fa84">aceWifiHal_reconnect</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gafff8c0a138c4466ae62ae52a6fe0210a">aceWifiHal_createAP</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga7c6be932c578c07d99cb89bce38be6ce">aceWifiHal_removeAP</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga4f7797eae6e4367baff5ccb76d833bb0">aceWifiHal_getStaList</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga1e39cb6635b9e2bc8ffe21575a6e933c">aceWifiHal_disconnectSta</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga8e2564950aadc4868ef1b3791c226dd3">aceWifiHal_enableNetwork</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga266546bf450065f8d622c3899bfae15c">aceWifiHal_disableNetwork</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga1f9422c21550c5fc90f3253743c8cb76">aceWifiHal_enableAllNetworks</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gac513617a1700457408ba2a0aba0f4cb1">aceWifiHal_disableAllNetworks</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gafe4134c87b6140ecb9971affc7772b62">aceWifiHal_getScanResults</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga7c2eb395228824db763e9caf5b3e4713">aceWifiHal_getDetailedScanResults</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gafd3874a286bac3747dfd40b7f3b39a59">aceWifiHal_getConfiguredNetworks</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gad5f3363e9059869351bf8bbf0ba8e229">aceWifiHal_getNetworkState</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga44dce9a3e0a2f012831d98906854d4e0">aceWifiHal_getConnectionInfo</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gaf52a587db106adaa19183419f3be8bb7">aceWifiHal_getIpInfo</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga41c09c6d3c607cf16a4397d071fe9447">aceWifiHal_getMacAddress</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga59032cba01a7df1d8fc15f0c0df806f3">aceWifiHal_setMacAddress</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga7b392b4adecae2eb6f646c46ad81ebcb">aceWifiHal_getAPMacAddress</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga2eb362f43f4d1147ca6c2d11a4633608">aceWifiHal_setCountryCode</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gaf2614fd09b166ac6e070d90ff3dff348">aceWifiHal_getCountryCode</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gafa1b4de4a064a34c416fecab87ff5a9f">aceWifiHal_getCoreWifiStats</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga769ad6c4c3835fba26f6945410735b36">aceWifiHal_getWifiCapability</a></li>
</ul>
<p>The APIs listed below are only needed when special ACS feature config is turned on: Static IP support (ACS feature: ACE_WIFI_STATIC_IP)</p><ul>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga098ee6dde7bf5e3f5702113b5a06fad6">aceWifiHal_startIpProvisioning</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gade6567647686783b87ef8116a80f43f9">aceWifiHal_stopIpProvisioning</a></li>
</ul>
<p>When DHCP is used (and static IP is not involved), the HAL implementation can decide to trigger DHCP automatically when Wi-Fi is connected, or wait for a call to <a class="el" href="group__ACE__HAL__WIFI.html#ga098ee6dde7bf5e3f5702113b5a06fad6">aceWifiHal_startIpProvisioning</a> to start the DHCP process.</p>
<p>Profile update feature support (ACS feature: ACE_WIFI_PROFILE_UPDATE)</p><ul>
<li>aceWifiHal_updateNetwork</li>
<li>aceWifiHal_restoreConfig</li>
</ul>
<p>IEEE8021X support (ACS feature: ACE_WIFI_IEEE8021X)</p><ul>
<li>aceWifiHal_synchronizeConfig This feature is for enterprise AP support only.</li>
</ul>
<p>Power control support (ACS feature: ACE_WIFI_POWER_CONTROL)</p><ul>
<li><a class="el" href="group__ACE__HAL__WIFI.html#ga76fef22adafa64d957bc31a2868854af">aceWifiHal_setPowerMode</a></li>
<li><a class="el" href="group__ACE__HAL__WIFI.html#gaf22413b057f4910aa3f1e33c6676c5a9">aceWifiHal_getPowerMode</a></li>
</ul>
<p>For detailed information on individual APIs, please refer to the <a class="el" href="group__ACE__HAL__WIFI.html">API documentation</a>.</p>
<h1><a class="anchor" id="wifi_example"></a>
Implementation example</h1>
<h1><a class="anchor" id="wifi_example_overall"></a>
Example of Wi-Fi Init Calling Flow.</h1>
<p>The example below shows the Wi-Fi HAL initialization. <a class="el" href="group__ACE__HAL__WIFI.html#ga154101eacf55b5ffb760ff3a310cfb6c">aceWifiHal_init()</a> is invoked as the first step. It may be invoked by the Wi-Fi middleware or the main task on the RTOS platform. Depending on the platform, this API may or may not need to be implemented.</p>
<p>For example, on a Linux platform, the Wi-Fi driver/supplicant can be started at device boot without waiting for <a class="el" href="group__ACE__HAL__WIFI.html#ga154101eacf55b5ffb760ff3a310cfb6c">aceWifiHal_init()</a>. In this case, <a class="el" href="group__ACE__HAL__WIFI.html#ga154101eacf55b5ffb760ff3a310cfb6c">aceWifiHal_init()</a> can be empty.</p>
<p>When the Wi-Fi HAL is ready (Wi-Fi chip initialization is completed and Wi-Fi profiles are read), <a class="el" href="group__ACE__HAL__WIFI.html#gga8c2cafdd3bbcca7035a395bc6e3abe05ac5eed06ff51fdb6053629e8ed3b06f16">aceWifiHal_wifiReadyEvent</a> needs to be sent back to the middleware layer.</p>
<div class="image">
<img src="wifi_example_overall.jpg" alt="wifi_example_overall.jpg"/>
</div>
<h1><a class="anchor" id="wifi_example_connect"></a>
Example of Flow Control for Connecting to API</h1>
<p>The example below shows how an asynchronous connect works.</p>
<div class="image">
<img src="wifi_example_connect.jpg" alt="wifi_example_connect.jpg"/>
</div>
 </div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.11-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
